# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏

## ‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ - 2025-11-22

### –¢–µ—Å—Ç 1: Health Check
```
GET /health
Status: 200 OK
Response: {"status": "ok"}
```
‚úÖ **PASSED**

### –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
```json
POST /api/v1/chat
{
  "prompt": "Say hello in one word",
  "user_id": 1
}

Response:
{
  "content": "Hello!",
  "session_id": "5772de0c-4217-43d8-85cb-ec7396f435ad",
  "cost": 0.0,
  "duration_ms": 2523
}
```
‚úÖ **PASSED**
- –ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞
- Session ID –ø–æ–ª—É—á–µ–Ω
- –û—Ç–≤–µ—Ç –æ—Ç Claude –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π

### –¢–µ—Å—Ç 3: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
```json
POST /api/v1/chat
{
  "prompt": "Now say goodbye in one word",
  "session_id": "5772de0c-4217-43d8-85cb-ec7396f435ad",
  "user_id": 1
}

Response:
{
  "content": "Goodbye!",
  "session_id": "5772de0c-4217-43d8-85cb-ec7396f435ad",
  "cost": 0.0,
  "duration_ms": 2984
}
```
‚úÖ **PASSED**
- –°–µ—Å—Å–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∞
- Session ID –æ—Å—Ç–∞–ª—Å—è —Ç–æ—Ç –∂–µ
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω

## –ë–∞–≥ Uvicorn

### –ü—Ä–æ–±–ª–µ–º–∞
–í–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ 500 –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–µ—Å—Å–∏–∏ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞.

### –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–≤–µ—Ç–∞ –î–û –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
# Create response object before logging (uvicorn bug workaround)
chat_response = ChatResponse(
    content=response.content,
    session_id=response.session_id,
    cost=response.cost,
    duration_ms=response.duration_ms,
)

logger.info("Request completed", ...)

return chat_response
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –û—à–∏–±–∫–∞ 500 –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç
‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200 OK

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Health check**: ~5ms
- **–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è**: ~2523ms (–≤–∫–ª—é—á–∞—è Claude API)
- **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏**: ~2984ms (–≤–∫–ª—é—á–∞—è Claude API)

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ:
- ‚úÖ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ Claude
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π
- ‚úÖ HTTP –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã

## –†–∞–±–æ—á–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

–§–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤: `/tmp/claude_user_{user_id}/`
- ‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```env
CLAUDE_API_KEY=test-api-key-change-me-in-production
PORT=8001
HOST=0.0.0.0
CLAUDE_TIMEOUT_SECONDS=300
CLAUDE_MAX_TURNS=50
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ API –∫–ª—é—á –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Bearer token
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤—Å–µ—Ö –≤ dev —Ä–µ–∂–∏–º–µ)
- ‚ö†Ô∏è –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–æ:
  - –ò–∑–º–µ–Ω–∏—Ç—å API –∫–ª—é—á –Ω–∞ —Å–ª–æ–∂–Ω—ã–π
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
  - –î–æ–±–∞–≤–∏—Ç—å HTTPS
  - –î–æ–±–∞–≤–∏—Ç—å rate limiting (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –ò—Ç–æ–≥

üéâ **–í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û**

–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –≤—ã–∫–ª–∞–¥–∫–µ –≤ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø.

### Checklist –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [x] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ù–µ—Ç –æ—à–∏–±–æ–∫ 500
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- [x] –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Requirements.txt —Å–æ–∑–¥–∞–Ω

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
cd project
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
python3 minimal_server.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python3 test_server.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
tail -f server.log
```
